<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Underwater Photogrammetry in Agisoft Metashape Workflow - BelowJS</title>
    <meta name="description" content="Complete photogrammetry processing pipeline from raw photos to web-ready models">
    <meta name="theme-color" content="#0d3b66">
    
    <!-- Analytics -->
    <script async defer data-website-id="f1e6105e-4969-4ffb-a3e1-8d18eca197d7" src="https://umami.padmorrison.com/umami.js"></script>
    
    <!-- Site styles -->
    <link rel="stylesheet" href="../assets/style.css">
    <link rel="stylesheet" href="../assets/docs.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <a href="../index.html" class="nav-title">BelowJS</a>
            <div class="nav-links">
                <a href="../installation.html">Installation</a>
                <a href="../examples.html">Examples</a>
                <a href="../guides.html">Guides</a>
                <a href="../implementations.html">Implementations</a>
                <a href="../changelog.html">Changelog</a>
                <div class="social-links">
                    <a href="https://github.com/patrick-morrison/belowjs" target="_blank" title="GitHub">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                    </a>
                    <a href="https://www.npmjs.com/package/belowjs" target="_blank" title="NPM">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M1.763 0C.786 0 0 .786 0 1.763v20.474C0 23.214.786 24 1.763 24h20.474c.977 0 1.763-.786 1.763-1.763V1.763C24 .786 23.214 0 22.237 0H1.763zM5.13 5.323l13.837.019-.009 13.836h-3.464l.01-10.382h-3.456L12.04 19.17H5.113L5.13 5.323z"/>
                        </svg>
                    </a>
                </div>
            </div>
            <div class="nav-toggle" onclick="toggleMobileNav()">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Mobile Navigation -->
    <div class="nav-mobile" id="nav-mobile">
        <a href="../installation.html">Installation</a>
        <a href="../examples.html">Examples</a>
        <a href="../guides.html">Guides</a>
        <a href="../implementations.html">Implementations</a>
        <a href="../changelog.html">Changelog</a>
        <a href="https://github.com/patrick-morrison/belowjs" target="_blank" class="nav-icon">
            <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
            GitHub
        </a>
        <a href="https://www.npmjs.com/package/belowjs" target="_blank" class="nav-icon">
            <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M1.763 0C.786 0 0 .786 0 1.763v20.474C0 23.214.786 24 1.763 24h20.474c.977 0 1.763-.786 1.763-1.763V1.763C24 .786 23.214 0 22.237 0H1.763zM5.13 5.323l13.837.019-.009 13.836h-3.464l.01-10.382h-3.456L12.04 19.17H5.113L5.13 5.323z"/>
            </svg>
            NPM
        </a>
    </div>

    <!-- Page Content -->
    <div class="docs-container">
        <div class="docs-content">
            <h1>Underwater Photogrammetry in Agisoft Metashape Workflow</h1>
            <p style="font-size: 0.9em; color: #666; margin-bottom: 1.5rem;"><em>Patrick Morrison, 17 August 2025</em></p>
            
            <p>BelowJS can use 3D models from any photogrammetry package. The industry standard is Agisoft Metashape, which produces excellent models even in challenging underwater conditions. This guide provides our approach to preparing a model in it, refer to the <a href="https://www.agisoft.com/pdf/metashape_2_1_en.pdf" target="_blank">manual</a> and other tutorials for an introduction to the software.</p>
            
            <h2>Image Capture</h2>
            <p>Image capture for photogrammetry relies on systematic collection and appropriate overlap. Typically this means swimming over a wreck site in a 'lawnmower' pattern, capturing an image every second or so, aiming for 70-80% overlap. For best camera calibration and to avoid gaps, this pattern should be done in two passes: first along the length of the wreck, then across the wreck perpendicularly. The camera should mostly point downward. Overhang imaging is lowest priority—tilt the camera when needed but avoid capturing too much water column. It takes practice.</p>
            
            <p>Any camera can be used. GoPros on timelapse are unreasonably effective. DSLRs, film cameras, and 360 cameras all work, with their own benefits and calibration challenges. The more detailed, consistent and sharper images, the better the results.</p>
            
            <h2>Processing</h2>
            <p>All your images should be loaded into Metashape, then you work down the <a href="https://www.agisoft.com/pdf/metashape_2_1_en.pdf" target="_blank">workflow menu</a> as below.</p>
            
            <h3>Align Photos</h3>
            <p>We use Medium or High settings depending on the processing power available. With a modern laptop and a few thousand images, High settings should only take a few hours. If you want to check results more quickly, Low quality settings are useful.</p>
            
            <p>Generic preselection is an excellent way to speed up high-quality datasets. For more difficult datasets, it may cause alignments to fail. Try with it enabled first, then turn it off if troubleshooting alignment issues.</p>
            
            <p><strong>Tip:</strong> Sometimes underwater datasets benefit from lower settings, because it smooths out the noise. If you are having trouble aligning, try reducing the accuracy setting.</p>
            
            <p><strong>Workflow → Align Images</strong></p>
            <ul>
                <li>High</li>
                <li>Generic Preselection</li>
                <li>Key point limit: 40,000</li>
                <li>Tie point limit: 0 (unlimited, 4,000 is also fine)</li>
                <li>Exclude stationary tie points</li>
                <li>No adaptive camera model fitting</li>
            </ul>
            
            <p>Once this is done you will see a point cloud, with the site starting to appear.</p>
            
            <h3>Build Model</h3>
            <p>The most time consuming step is building the model. The quality chosen here will directly affect your final output, at the cost of processing time and storage space. We will reduce the polygon count later, but higher quality inputs produce better results when reduced than starting with low quality.</p>
            
            <p><strong>Workflow → Build Model</strong></p>
            <p><strong>Depth maps</strong></p>
            <ul>
                <li>Quality: High</li>
                <li>Face Count: High</li>
                <li>Interpolation: Enabled</li>
                <li>Depth Filtering: Mild</li>
            </ul>
            
            <h3>Decimate</h3>
            <p>The <a href="vr-headsets.html">Meta Quest 3 headset</a> has been tested with models from 1 to 1.2 million polygons, beyond that, it can struggle. Use Tools → Models → Decimate models to reduce the polygon count. For lower tier devices or slower internet connections, 500,000 may be a better target.</p>
            
            <h3>Build Texture</h3>
            <p>Once the model is at the target polygon count, you can build textures. A single texture map can be easier to deal with, but 4 × 4k textures are tested to be the most detailed option usable on standard VR headsets. You could consider a single 4k texture for lighter applications.</p>
            
            <p><strong>Workflow → Build Texture</strong></p>
            <ul>
                <li>Texture type: Diffuse</li>
                <li>Source data: Images</li>
                <li>Mapping mode: Generic</li>
                <li>Blending mode: Mosaic</li>
                <li>Texture Size: 4096</li>
                <li>Page Count: 4</li>
                <li>Enable hole filling</li>
                <li>Don't enable ghosting filter</li>
            </ul>
            
            <h2>Next Steps</h2>
            <p>Before exporting as a .glb file, we first <a href="model-setup.html">orient and scale</a> the model.</p>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <p>GPL-3.0 Licensed. Open Source.</p>
            <p>Created by <a href="https://padmorrison.com">Patrick Morrison</a></p>
        </div>
    </footer>

    <!-- Navigation JavaScript -->
    <script src="../assets/navigation.js"></script>
</body>
</html>
