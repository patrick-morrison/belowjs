<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BelowJS - Cylindrical Display Example</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸš¢</text></svg>'" />
  <link rel="stylesheet" href="/dist/belowjs.css" />
  <style>
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #ffffff;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    
    /* Hide VR button completely */
    #VRButton,
    button[id*="VR"],
    div[id*="VR"] button,
    .vr-button-glass {
      display: none !important;
    }
    
    /* Hide model selector completely */
    #modelSelector {
      display: none !important;
    }
  </style>
</head>
<body>
  <script type="module">
    import * as THREE from 'three';
    import { ModelViewer, CylindricalStereoRenderer } from '/dist/belowjs.es.js';

    const models = {
      'kxi': {
        url: '../basic/models/kxi.glb',
        name: 'HNLMS K XI (1946)',
        credit: 'WreckSploration',
        initialPositions: {
          desktop: {
            camera: { x: -6.391, y: 12.461, z: -42.105 },
            target: { x: 1.529, y: 0.088, z: -14.334 }
          }
        }
      }
    };

    const currentModel = 'kxi';
    const viewerContainer = document.createElement('div');
    viewerContainer.style.position = 'fixed';
    viewerContainer.style.inset = '0';
    document.body.appendChild(viewerContainer);

    const viewer = new ModelViewer(viewerContainer, {
      enableControls: true,
      enableMeasurement: false,
      enableVRAudio: false,
      enableFullscreen: true,
      enableVR: false,
      enableDiveSystem: true,
      models,
      showStats: false,
      showStatus: false,
      autoRotate: false,
      viewerConfig: {
        scene: { 
          backgroundColor: '#ffffff'
        }
      },
      initialModel: currentModel,
      initialPositions: models[currentModel].initialPositions
    });

    // Survey lighting enabled via enableDiveSystem: true

    // Cylindrical stereo rendering
    const bv = viewer.belowViewer;
    const renderer = bv.getRenderer();
    const scene = bv.getScene();
    const camera = bv.getCamera();
    const cylinder = new CylindricalStereoRenderer(renderer, scene);

    let lastTime = 0;
    renderer.setAnimationLoop((time) => {
      const deltaTime = Math.min((time - lastTime) / 1000, 0.1);
      lastTime = time;

      if (bv.vrManager) bv.vrManager.update(deltaTime);
      if (bv.cameraManager) bv.cameraManager.update();
      bv.emit('before-render', deltaTime);

      cylinder.render(camera);
    });

    // No model selector - fixed to K XI model
  </script>
</body>
</html>
